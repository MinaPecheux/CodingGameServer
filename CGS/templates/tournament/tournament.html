{% extends "base.html" %}


{% block script %}
<script type="text/javascript">
    var ws = new WebSocket( "ws://{{ host }}:{{ webPort }}/websocket/Tournament/{{ t.name }}" );
    ws.onmessage = function (evt) {
        /* the server send a dictionary (JSON) with information about the game */
        var data = JSON.parse(evt.data);
        document.getElementById('div_nbPlayers').innerHTML = data['nbPlayers'];
        document.getElementById('div_phase').innerHTML = data['phase'];
        document.getElementById('div_score').innerHTML = data['score'];
        document.getElementById('list_players').innerHTML = "<ul class='triple'>" + data['Players'].map(function (x){return "<li>"+x+"</li>"}).join("") + "</ul>";
        document.getElementById('list_games').innerHTML = "<ul>" + data['Games'].map(function (x){return "<li>"+x+"</li>"}).join("") + "</ul>";
        document.getElementById('runPhaseButton').disabled = !(data['runPhaseButton']);
        ws.send('OK')
    };
</script>
{% endblock %}


{% block content %}
Tournament {{t.name}}
<hr/>
Parameters:
<ul>
    <li>nb Max Players = {{t.nbMaxPlayers}}</li>
    <li>nb rounds for victory = {{t.nbRounds4Victory}}</li>
    <li>mode = {{t.mode}}</li>
</ul>
<!-- websocket-updated data -->
<hr/>

    <div id="div_nbPlayers"></div> players are registred:
<div id="list_players"></div>

<hr/>
Phase:<div id="div_phase"></div><br/>
Games:<br/>
<div id="list_games"></div>

    <form action="{{ base_url }}run_tournament/{{t.name}}" method="POST">
    {{ t.HTMLgameoptions }}
    <br/>
    <button name="send" id="runPhaseButton">Run Phase !!</button>
    </form>

<hr/>
<div id="div_score"></div>
{%  endblock %}
